install.packages("dplyr")
install.packages("zoo")
install.packages("xts")
library(zoo)
library(dplyr)
library(xts)
library(lubridate)
library(ggplot2)
setwd("C:\\Users\\austi\\Documents\\Github_Repos\\Macro_Finance\\Assignment-1\\Data")
tyear = read.csv("TBill_Annual.csv")
tquart= read.csv("TBill_Quarterly.csv")
crsp = read.csv("crsp_monthly.csv")
tquart$caldt= ymd(tquart$caldt)
tquart = xts(tquart[,-1], order.by = tquart[,1])
tyear$caldt= ymd(tyear$caldt)
tyear = xts(tyear[,-1], order.by = tyear[,1])
crsp$DATE= ymd(crsp$DATE)
crsp1= xts(crsp[,-1], order.by = crsp[,1])
qcrsped= apply.quarterly(crsp1[,1], sum)
qcrspex= apply.quarterly(crsp1[,2], sum)
qcrsp = cbind(qcrsped, qcrspex)
ycrsped= apply.yearly(crsp1[,1], sum)
ycrspex= apply.yearly(crsp1[,2], sum)
ycrsp = cbind(ycrsped, ycrspex)
qcrsp= cbind(qcrsp, qcrsp[,1]-qcrsp[,2])
ycrsp= cbind(ycrsp, ycrsp[,1]-ycrsp[,2])
colnames(qcrsp)[3]= "qyield"
colnames(ycrsp)[3]= "yyield"
plot.xts( qcrsp[,3], main= "Quarterly Dividend Yield", xlab = "Time", ylab= "Dividend Yield")
plot.xts( ycrsp[,3], main= "Yearly Dividend Yield", xlab = "Time", ylab= "Dividend Yield")
tquart = cbind(tquart, tquart[,1]-tquart[,2])
colnames(tquart)[3] = "qrf"
tyear = cbind(tyear, tyear[,1]-tyear[,2])
colnames(tyear)[3] = "yrf"
year = merge.xts(tyear, ycrsp, join= "inner")
year = year[,c(3,6)]
year = cbind(year, exp(ycrsp$vwretd)-1-year$yrf)
year[,2]= (exp(year[,2])-1)
colnames(year)[3]= "ymktxs"
year[,3]=lag(year[,3])
year=year[-1,]
quarter = merge.xts(tquart, qcrsp, join= "inner")
quarter = quarter[, c(3,6)]
quarter = cbind(quarter, exp(qcrsp$vwretd)-1-quarter$qrf)
quarter[,2]= (exp(quarter[,2])-1)
colnames(quarter)[3]= "qmtkxs"
quarter[,3]=lag(quarter[,3])
quarter=quarter[-1,]
qprediction = lm(quarter$qmtkxs~quarter$qyield, quarter)
yprediction = lm(year$ymktxs~year$yyield, year)
summary(qprediction)
summary(yprediction)
window_size = 15
window_tot  = nrow(year) - window_size + 1
Q <- matrix(0, window_tot, 1)
for (i in c(1:window_tot)) {
rol_X = year[i:(window_size+i-1),]
result <- lm(rol_X$ymktxs~(rol_X$yyield), rol_X)
Q[i] = summary(result)$adj.r.squared
}
plot(Q)
time = c(seq(from = 1946, to = 2003, by = 1))
time= as.vector(time)
U=cbind(Q, time)
plot(U[,2], U[,1], main = "Adjusted R-Squared", xlab= "Starting Year of Window", ylab = "Adjusted R-Squared Value", type ="b" )
